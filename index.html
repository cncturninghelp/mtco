<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>First Cut — MTCO (Unified Shell + Quizzes)</title>
  <meta name="description" content="MTCO unified offline shell — one header, tabs for each tool, and an iframe to load them. Includes Quizzes." />
  <style>
    :root{
      --bg:#0f1215; --card:#171b21; --border:#2b3139; --text:#e6e8eb; --muted:#8a9097;
      --accent:#ff7a1a; --accent2:#ffa864; --radius:14px;
      --fs-body:14px; --lh-body:1.45;
    }
    html,body{height:100%}
    *{box-sizing:border-box}
    /* Ensure [hidden] really collapses in all cases */
    [hidden]{display:none !important}
    body{
      margin:0; background:var(--bg); color:var(--text);
      font:600 var(--fs-body)/var(--lh-body) ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";
    }
    a{color:var(--text); text-decoration:none}
    /* Header */
    header{position:sticky; top:0; z-index:10;
      background:linear-gradient(180deg,#181d24,#14181d);
      border-bottom:1px solid var(--border);
      box-shadow:0 6px 24px rgba(0,0,0,.25);
    }
    .wrap{max-width:1220px; margin:0 auto; padding:12px 14px}
    .brandrow{display:flex; align-items:center; justify-content:space-between; gap:12px}
    .brand{display:flex; align-items:center; gap:12px}
    .logo{width:36px; height:36px; border-radius:8px;
      background:linear-gradient(135deg,var(--accent),var(--accent2));
      box-shadow:0 2px 12px rgba(255,122,26,.35)
    }
    .title{font-weight:900; letter-spacing:.3px; font-size:20px}
    .tag{color:#cfd3d8; font-size:12px}
    .actions{display:flex; gap:8px; flex-wrap:wrap}
    .btn{background:#1a1f26; border:1px solid var(--border); color:var(--text); padding:7px 10px; border-radius:10px; cursor:pointer}
    .btn.primary{background:var(--accent); color:#111; border-color:transparent}
    .btn:disabled{opacity:.5; cursor:not-allowed}
    .openlink{background:#1a1f26; border:1px solid var(--border); padding:7px 10px; border-radius:10px}
    /* Tabs */
    .tabswrap{margin-top:8px}
    .tabs{display:flex; gap:8px; overflow-x:auto; -webkit-overflow-scrolling:touch; padding-bottom:8px}
    .tab{background:#1a1f26; border:1px solid var(--border); color:var(--text); padding:6px 10px; border-radius:999px; cursor:pointer; white-space:nowrap}
    .tab.active{background:var(--accent); color:#111; border-color:transparent}
    /* Main */
    main{height:calc(100% - 130px)}
    .content{max-width:1220px; margin:0 auto; height:100%; padding:12px 14px}
    .card{background:var(--card); border:1px solid var(--border); border-radius:var(--radius); height:100%; display:flex; flex-direction:column; overflow:hidden}
    .blank{display:flex; align-items:center; justify-content:center; flex:1; color:var(--muted); text-align:center; padding:24px}
    .frame{border:0; width:100%; flex:1; background:#0a0d10}
    .foot{color:var(--muted); font-size:12px; padding:8px 12px; border-top:1px solid var(--border)}
    .kbd{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; background:#11161c; border:1px solid var(--border); padding:2px 6px; border-radius:6px}
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <div class="brandrow">
        <div class="brand">
          <div class="logo" aria-hidden="true"></div>
          <div>
            <div class="title">MTCO — Measure Twice, Cut Once</div>
            <div class="tag">Unified offline tools — Fanuc lathe convention (G18, Z0 at right face, work Z−)</div>
          </div>
        </div>
        <div class="actions" id="actionsRow" aria-live="polite">
          <button id="btnSampleHdr" class="btn" disabled>Load MTCO sample</button>
          <button id="btnFitHdr" class="btn" disabled>Auto-fit</button>
          <a id="openExternal" class="openlink" href="#" target="_blank" rel="noopener">Open standalone</a>
        </div>
      </div>
      <div class="tabswrap">
        <div class="tabs" role="tablist" aria-label="MTCO sections">
          <button class="tab active" data-key="home" role="tab" aria-selected="true">Home</button>
          <button class="tab" data-key="code" role="tab">Code Builder</button>
          <button class="tab" data-key="threads" role="tab">Threads</button>
          <button class="tab" data-key="preview" role="tab">Toolpath Preview</button>
          <button class="tab" data-key="planner" role="tab">Job Planner</button>
          <button class="tab" data-key="gallery" role="tab">Gallery</button>
          <button class="tab" data-key="trig" role="tab">Turning Trig</button>
          <button class="tab" data-key="feeds" role="tab">Feeds &amp; Speeds</button>
          <button class="tab" data-key="quizzes" role="tab">Quizzes</button>
        </div>
      </div>
    </div>
  </header>

  <main>
    <div class="content">
      <div class="card">
        <div id="blankHome" class="blank">
          <div>
            <p>Home is blank on purpose. Choose a tab above.</p>
            <p>Tip: If the Quizzes page doesn’t load questions, run a local server (e.g. <span class="kbd">python -m http.server 8000</span>), then open <span class="kbd">http://localhost:8000/index.html</span>.</p>
          </div>
        </div>
        <iframe id="frame" class="frame" title="MTCO content" loading="lazy" hidden></iframe>
        <div class="foot">Tip: “Open standalone” opens the current tool in a new tab. The header buttons only work on Toolpath Preview.</div>
      </div>
    </div>
  </main>

  <script>
    const PAGES = {
      home:        { href: "",                                                     showFrame:false },
      code:        { href: "fc_code_builder_trial_v1_6_orange.html" },
      threads:     { href: "mtco_thread_data_wizard_v1.html" },
      preview:     { href: "mtco_toolpath_preview_trial_v3i_lathe.html", previewControls:true },
      planner:     { href: "mtco_job_planner_v1.html" },
      gallery:     { href: "mtco_gallery_trial_v1_fixed.html" },
      trig:        { href: "Turning_Trig_Utility_MTCO_v1.html" },
      feeds:       { href: "Feeds_Speeds_MTCO_v1.html" },
      quizzes:     { href: "quiz.html" }
    };

    const frame = document.getElementById('frame');
    const btnSampleHdr = document.getElementById('btnSampleHdr');
    const btnFitHdr = document.getElementById('btnFitHdr');
    const openExternal = document.getElementById('openExternal');
    const blank = document.getElementById('blankHome');
    const tabs = Array.from(document.querySelectorAll('.tab'));

    let currentKey = 'home';

    function setActive(key){
      currentKey = key;
      tabs.forEach(t => t.classList.toggle('active', t.dataset.key === key));
      const cfg = PAGES[key];
      if(!cfg || key === 'home' || !cfg.href){
        frame.setAttribute('hidden','');
        blank.removeAttribute('hidden');
        openExternal.href = '#';
        btnSampleHdr.disabled = true;
        btnFitHdr.disabled = true;
        return;
      }
      // show iframe, hide blank panel
      frame.removeAttribute('hidden');
      blank.setAttribute('hidden','');
      // load page
      frame.src = cfg.href;
      openExternal.href = cfg.href;
      const isPreview = !!cfg.previewControls;
      btnSampleHdr.disabled = !isPreview;
      btnFitHdr.disabled = !isPreview;
    }

    tabs.forEach(t => t.addEventListener('click', () => setActive(t.dataset.key)));

    frame.addEventListener('load', () => {
      if(currentKey !== 'preview') return;
      try{
        const doc = frame.contentWindow.document;
        const btnSample = doc.getElementById('btnSample') || doc.getElementById('btnSampleIK');
        const btnFit = doc.getElementById('btnFit');
        btnSampleHdr.onclick = () => { btnSample && btnSample.click(); };
        btnFitHdr.onclick = () => { btnFit && btnFit.click(); };
      }catch(e){
        console.warn('Could not bind preview controls:', e);
      }
    });

    setActive('home');
  </script>
</body>
</html>
