<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>MTCO â€” Measure Twice, Cut Once</title>
  <style>
    :root{
      --bg:#0f1215;
      --card:#171b21;
      --border:#2b3139;
      --text:#e6e8eb;
      --muted:#8a9097;
      --accent:#ff7a1a;
      --radius:14px;
      --fs-body:14px;
      --lh-body:1.45;
    }
    html,body{height:100%;}
    body{margin:0;background:var(--bg);color:var(--text);font:600 var(--fs-body)/var(--lh-body) ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;}
    a{color:var(--text);text-decoration:none;}
    /* Header */
    header{border-bottom:1px solid var(--border);background:#111418;}
    .wrap{max-width:1200px;margin:0 auto;padding:12px;}
    .brandrow{display:flex;align-items:baseline;justify-content:space-between;gap:12px;}
    .title{font-weight:900;font-size:20px;letter-spacing:0.3px;}
    .tag{font-weight:600;color:var(--muted);font-size:14px;}
    .actions{display:flex;gap:10px;align-items:center;padding:8px 0;}
    .btn{background:#1a1f26;border:1px solid var(--border);color:var(--text);padding:6px 10px;border-radius:10px;cursor:pointer;}
    .btn.primary{background:var(--accent);color:#111;border-color:transparent;}
    .openlink{background:#1a1f26;border:1px solid var(--border);padding:6px 10px;border-radius:10px;}
    .tabswrap{margin-top:6px;}
    .tabs{display:flex;gap:8px;overflow-x:auto;-webkit-overflow-scrolling:touch;padding:8px 0;}
    .tab{background:#1a1f26;border:1px solid var(--border);color:var(--text);padding:6px 10px;border-radius:10px;cursor:pointer;white-space:nowrap;}
    .tab.active{background:var(--accent);color:#111;border-color:transparent;}
    /* Main */
    main{height:calc(100% - 130px);}
    .content{max-width:1200px;margin:0 auto;height:100%;padding:12px;}
    .card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:0;height:100%;display:flex;flex-direction:column;}
    .frame{border:0;width:100%;flex:1;border-top:1px solid var(--border);background:#0a0d10;}
    .blank{display:flex;align-items:center;justify-content:center;flex:1;color:var(--muted);}
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <div class="brandrow">
        <div>
          <div class="title">MTCO</div>
          <div class="tag">Measure Twice, Cut Once</div>
        </div>
        <div class="actions" id="actionsRow">
          <!-- Preview-only buttons (shown only on Toolpath Preview) -->
          <button id="btnSampleHdr" class="btn">Load MTCO sample</button>
          <button id="btnFitHdr" class="btn">Auto-fit</button>
          <!-- Open current tool in a new tab -->
          <a id="openExternal" class="openlink" href="#" target="_blank" rel="noopener">Open standalone</a>
        </div>
      </div>
      <div class="tabswrap">
        <div class="tabs" role="tablist">
          <button class="tab active" data-key="home" role="tab" aria-selected="true">Home</button>
          <button class="tab" data-key="code" role="tab">Code Builder</button>
          <button class="tab" data-key="threads" role="tab">Threads</button>
          <button class="tab" data-key="preview" role="tab">Toolpath Preview</button>
          <button class="tab" data-key="planner" role="tab">Job Planner</button>
          <button class="tab" data-key="gallery" role="tab">Gallery</button>
          <button class="tab" data-key="trig" role="tab">Turning Trig</button>
          <button class="tab" data-key="feeds" role="tab">Feeds & Speeds</button>
        </div>
      </div>
    </div>
  </header>

  <main>
    <div class="content">
      <div class="card">
        <div id="blankHome" class="blank">Home is blank on purpose. Choose a tab above.</div>
        <iframe id="frame" class="frame" title="MTCO content" loading="lazy"></iframe>
      </div>
    </div>
  </main>

  <script>
    // Routes (targets are your existing pages)
    const routes = {
      home: "index.html",
      code: "fc_code_builder_trial_v1_6_orange.html",
      threads: "mtco_thread_data_wizard_v1.html",
      preview: "mtco_toolpath_preview_trial_v3i_lathe.html",
      planner: "mtco_job_planner_v1.html",
      gallery: "mtco_gallery_trial_v1_fixed.html",
      trig: "Turning_Trig_Utility_MTCO_v1.html",
      feeds: "Feeds_Speeds_MTCO_v1.html"
    };

    // Elements
    const tabs = Array.from(document.querySelectorAll('.tab'));
    const frame = document.getElementById('frame');
    const openExternal = document.getElementById('openExternal');
    const actionsRow = document.getElementById('actionsRow');
    const blankHome = document.getElementById('blankHome');
    const btnSampleHdr = document.getElementById('btnSampleHdr');
    const btnFitHdr = document.getElementById('btnFitHdr');

    function setPreviewButtonsVisible(visible){
      if(!btnSampleHdr || !btnFitHdr) return;
      btnSampleHdr.style.display = visible ? '' : 'none';
      btnFitHdr.style.display = visible ? '' : 'none';
    }

    function setActive(key){
      // tab UI
      tabs.forEach(t => {
        const active = (t.dataset.key === key);
        t.classList.toggle('active', active);
        if(active) t.setAttribute('aria-selected', 'true'); else t.removeAttribute('aria-selected');
      });

      // Show header actions except on Home; show preview-only buttons only on Preview
      const isHome = (key === 'home');
      const isPreview = (key === 'preview');
      if(actionsRow) actionsRow.style.display = isHome ? 'none' : '';
      setPreviewButtonsVisible(isPreview);

      if(key === 'home'){
        if(frame){ frame.src = 'about:blank'; frame.style.display = 'none'; }
        if(blankHome) blankHome.style.display = '';
        if(openExternal){ openExternal.removeAttribute('href'); openExternal.setAttribute('aria-disabled', 'true'); }
        return;
      }else{
        if(blankHome) blankHome.style.display = 'none';
        if(frame) frame.style.display = '';
        if(openExternal) openExternal.removeAttribute('aria-disabled');
      }

      const url = routes[key] + (routes[key].includes('?') ? '&' : '?') + 'embed=1';
      if(frame) frame.src = url;
      if(openExternal) openExternal.href = routes[key];
    }

    // Forward header preview buttons into the Toolpath Preview page
    function forwardToPreviewButton(innerId){
      try{
        const doc = frame && frame.contentWindow ? frame.contentWindow.document : null;
        const el = doc ? doc.getElementById(innerId) : null;
        if(el){ el.click(); }
      }catch(e){
        console.warn('Preview button forwarding failed:', e);
      }
    }
    if(btnSampleHdr){ btnSampleHdr.addEventListener('click', () => forwardToPreviewButton('btnSample')); }
    if(btnFitHdr){ btnFitHdr.addEventListener('click', () => forwardToPreviewButton('btnFit')); }

    // Bind clicks
    tabs.forEach(btn => btn.addEventListener('click', () => setActive(btn.dataset.key)));

    // Default to Home (blank)
    setActive('home');
  </script>
</body>
</html>
